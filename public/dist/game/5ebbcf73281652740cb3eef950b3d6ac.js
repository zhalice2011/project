

require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var s=e[n]=new t.Module(n);r[n][0].call(s.exports,i,s,s.exports)}return e[n].exports}function o(r){this.id=r,this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.isParcelRequire=!0,t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({6:[function(require,module,exports) {
var e={status:"start",score:0,level:1,totalLevel:6,levels:["","第一关","第二关","第三关","第四关","第五关","第六关"],numPerLine:[0,7,7,8,8,8,8],enemyLineCount:[0,1,2,2,2,3,4],enemyBoomFrameCount:3,scorePerEnemy:[0,1,2,3,4,5,6],canvasPadding:30,bulletLength:10,bulletWidth:1,bulletSpeed:8,bulletsFrameGap:5,enemySpeed:[0,2,3,2,2,2,2],enemySize:50,enemyGap:10,enemyIcon:"/dist/game/enemy.png",enemyBoomIcon:"/dist/game/boom.png",enemyDirection:"right",planeSpeed:20,movePerFrame:5,planeSize:{width:60,height:100},planeIcon:"/dist/game/plane.png"},t=document.getElementById("game"),i=document.getElementById("canvas"),n=i.getContext("2d");function o(){n.clearRect(0,0,i.width,i.height);var t=e.enemySize;a.enemies.forEach(function(e,i){e.boomFrameCnt>0&&(e.isAlive?n.drawImage(e.img,e.left,e.top,t,t):n.drawImage(e.boomImg,e.left,e.top,t,t))}),n.drawImage(s.img,s.left,s.top,e.planeSize.width,e.planeSize.height),s.bullets.forEach(function(t){n.beginPath(),n.moveTo(t.left,t.top),n.lineTo(t.left,t.top-e.bulletLength),n.stroke()}),n.fillText("分数："+a.score,20,40)}function l(e,t){this.left=e,this.top=t}n.lineWidth=e.bulletWidth,n.strokeStyle="#ffffff",n.font="18px arial",n.fillStyle="#ffffff";var s={init:function(){this.bullets=[],this.left=i.width/2-e.planeSize.width/2,this.top=i.height-e.planeSize.height-30,this.img=new Image,this.img.src=e.planeIcon,this.target=i.width/2-e.planeSize.width/2,this.leftMoving=!1,this.rightMoving=!1,this.lastKey=null,this.shooting=!1,this.lastBulletFrame=0},move:function(t){if(this.left===this.target)switch(t){case"left":this.target-=e.planeSpeed,this.target<a.leftEdge&&(this.target=a.leftEdge);break;case"right":this.target+=e.planeSpeed,this.target>a.rightEdge-e.planeSize.width&&(this.target=a.rightEdge-e.planeSize.width)}},shoot:function(){this.bullets.push(new l(this.left+e.planeSize.width/2,this.top))}};function r(t,i){this.isAlive=!0,this.left=t,this.top=i,this.boomFrameCnt=e.enemyBoomFrameCount}r.prototype.img=new Image,r.prototype.img.src=e.enemyIcon,r.prototype.move=function(){switch(this.direction){case"right":this.left+=a.enemyAttr.speed;break;case"left":this.left-=a.enemyAttr.speed}};var a={init:function(t){this.status=e.status,this.level=t.level;var n=this.level,o=e.enemyLineCount[n],l=e.numPerLine[n],h=e.canvasPadding,c=e.enemySize,g=e.enemyGap;document.querySelector(".game-level").innerHTML=e.levels[n],this.frameCnt=0,this.score=t.score,this.scorePerEnemy=e.scorePerEnemy[n],this.leftEdge=h,this.rightEdge=i.width-h,this.enemies=new Array(o*l),this.enemyAttr={direction:"right",enemySpeed:e.enemySpeed[n],numPerLine:l,enemyLineCount:o,leftEdge:h,rightEdge:h+l*(c+g)-g,topEdge:h,bottomEdge:h+o*(c+g)-g,initLeftEdge:h,initTopEdge:h,horizontalEles:new Array(l).fill(o,0),verticalEles:new Array(o).fill(l,0)};for(var m=0;m<this.enemies.length;++m){var f=m%l,d=Math.floor(m/l),u=a.enemyAttr.leftEdge+f*(c+g),p=a.enemyAttr.topEdge+d*(c+g);this.enemies[m]=new r(u,p)}this.bindEvent(),s.init()},bindEvent:function(){var e=this,t=document.querySelectorAll(".js-play"),i=document.querySelectorAll(".js-replay"),n=document.querySelector(".js-next");t.forEach(function(t){t.onclick=function(){e.play()}}),i.forEach(function(t){t.onclick=function(){e.replay()}}),n.onclick=function(){e.goToNextLevel()},document.onkeydown=function(t){switch(t.keyCode||t.which||t.charCode){case 32:case 38:s.shooting||(s.shooting=!0);break;case 37:s.leftMoving||(s.leftMoving=!0,s.lastKey="left");break;case 39:s.rightMoving||(s.rightMoving=!0,s.lastKey="right");break;case 13:"playing"===e.status&&e.setStatus("pause")}},document.onkeyup=function(e){switch(e.keyCode||e.which||e.charCode){case 32:case 38:s.shooting=!1;break;case 37:s.leftMoving=!1,s.lastKey="right";break;case 39:s.rightMoving=!1,s.lastKey="left"}}},setStatus:function(i){this.status=i,t.setAttribute("data-status",i);var n=null;switch(i){case"pause":n=document.querySelector(".game-pause .score");break;case"failed":n=document.querySelector(".game-failed .score");break;case"success":n=document.querySelector(".game-success .score"),document.querySelector(".game-success .next-level").innerHTML=e.levels[a.level+1];break;case"all-success":n=document.querySelector(".game-all-success .score")}null!==n&&(n.innerHTML=this.score)},play:function(){this.setStatus("playing"),this.animate()},replay:function(){this.init(e),this.play()},goToNextLevel:function(){this.init({level:this.level+1,score:this.score}),this.play()},animate:function(){var t,l,r,h=a;++h.frameCnt,s.bullets.forEach(function(t){t.top-=e.bulletSpeed}),s.bullets[0]&&s.bullets[0].top<0&&s.bullets.shift(),s.left<s.target?s.left=Math.min(s.left+e.movePerFrame,s.target):s.left>s.target&&(s.left=Math.max(s.left-e.movePerFrame,s.target)),s.shooting&&h.frameCnt>s.lastBulletFrame+e.bulletsFrameGap&&(s.shoot(),s.lastBulletFrame=h.frameCnt),s.leftMoving&&"left"===s.lastKey?s.move("left"):s.rightMoving&&"right"===s.lastKey&&s.move("right"),function(){var t=h.enemyAttr,i=!1,n=h.enemyAttr.enemySpeed;"right"===t.direction?(t.rightEdge+=n,t.leftEdge+=n,t.initLeftEdge+=n):(t.rightEdge-=n,t.leftEdge-=n,t.initLeftEdge-=n);var o=e.enemyGap,l=e.enemySize;"right"===t.direction&&t.rightEdge>h.rightEdge?(t.direction="left",t.topEdge+=o+l,t.bottomEdge+=o+l,t.initTopEdge+=o+l,i=!0):"left"===t.direction&&t.leftEdge<h.leftEdge&&(t.direction="right",t.topEdge+=o+l,t.bottomEdge+=o+l,t.initTopEdge+=o+l,i=!0),t.bottomEdge>s.top?h.setStatus("failed"):h.enemies.forEach(function(o){"right"===t.direction?o.left+=n:o.left-=n,i&&(o.top+=e.enemyGap+e.enemySize),o.isAlive||--o.boomFrameCnt})}(),t=h.enemyAttr,l=e.enemyGap,r=e.enemySize,s.bullets.forEach(function(i,n,o){if(i.top>t.topEdge&&i.top<t.bottomEdge&&i.left>t.leftEdge&&i.left<t.rightEdge){var s=Math.floor((i.left-t.initLeftEdge)/(r+l)),a=(i.left-t.initLeftEdge)%(r+l),c=Math.floor((i.top-t.initTopEdge)/(r+l)),g=(i.top-t.initTopEdge)%(r+l);if(a>r||g>r)return;var m=c*t.numPerLine+s;if(h.enemies[m].isAlive){if(h.score+=h.scorePerEnemy,o[n].top=-e.bulletLength,h.enemies[m].isAlive=!1,h.enemies[m].boomImg=new Image,h.enemies[m].boomImg.src=e.enemyBoomIcon,--t.horizontalEles[s],--t.verticalEles[c],0===t.horizontalEles[s]){var f=t.horizontalEles.findIndex(function(e){return e>0});if(-1===f)return void(h.level===e.totalLevel?h.setStatus("all-success"):h.setStatus("success"));for(var d=t.numPerLine-1;0===t.horizontalEles[d];)--d;t.leftEdge=t.initLeftEdge+f*(r+l),t.rightEdge=t.initLeftEdge+d*(r+l)+r}if(0===t.verticalEles[c]){for(var u=t.verticalEles.findIndex(function(e){return e>0}),p=t.enemyLineCount-1;0===t.verticalEles[p];)--p;t.topEdge=t.initTopEdge+u*(r+l),t.bottomEdge=t.initTopEdge+p*(r+l)+r}}}}),"playing"===h.status?(o(),requestAnimationFrame(h.animate)):n.clearRect(0,0,i.width,i.height)}};a.init(e);
},{}]},{},[6])